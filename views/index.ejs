<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Members Dashboard</title>
</head>
<body>
  <h1>Welcome to the Members Dashboard</h1>

  <h2>Members:</h2>
<ul>
  <% members.forEach(function(member) { %>
    <li>
      <strong><%= member.name %></strong>
      <form action="/update-attendance" method="POST">
        <input type="hidden" name="memberName" value="<%= member.name %>">
        <label>Attendance:</label>
        <% for (let i = 0; i < 8; i++) { %>
          <input type="checkbox" name="<%= member.name %>[]" value="true" <%= member.attendance[i] ? "checked" : "" %>> Event <%= i + 1 %>
        <% } %>
        <input type="submit" value="Update Attendance">
      </form>
    </li>
  <% }) %>
</ul>

  <!-- Add Member Form -->
  <h3>Add Member:</h3>
  <form action="/add-member" method="POST">
    <label for="name">Member Name:</label>
    <input type="text" name="name" required>
    <input type="submit" value="Add Member">
  </form>

  <!-- Category Section -->
  <h2>Categories:</h2>
  <ul>
    <% Object.keys(categories).forEach(function(category) { %>
      <li>
        <strong><%= category %></strong>:
        <ul>
          <% categories[category].forEach(function(item) { %>
            <li>
              <%= item %>
              <form action="/remove-item" method="POST">
                <input type="hidden" name="category" value="<%= category %>">
                <input type="hidden" name="item" value="<%= item %>">
                <input type="submit" value="Remove Item">
              </form>
            </li>
          <% }) %>
        </ul>
        <form action="/add-item" method="POST">
          <input type="hidden" name="category" value="<%= category %>">
          <label for="item">Add Item:</label>
          <input type="text" name="item" required>
          <input type="submit" value="Add Item">
        </form>
      </li>
    <% }) %>
  </ul>

  <!-- Need List Section -->
  <h2>Need List:</h2>
  <ul>
    <% members.forEach(function(member) { %>
      <li>
        <strong><%= member.name %></strong>
        <ul>
          <% Object.keys(categories).forEach(function(category) { %>
            <% if (member.items[category]) { %>
              <% member.items[category].forEach(function(item) { %>
                <li>
                  <%= item %> 
                  <form action="/revoke-need" method="POST">
                    <input type="hidden" name="member" value="<%= member.name %>">
                    <input type="hidden" name="category" value="<%= category %>">
                    <input type="hidden" name="item" value="<%= item %>">
                    <input type="submit" value="Revoke">
                  </form>
                </li>
              <% }) %>
            <% } %>
          <% }) %>
        </ul>
        <form action="/assign-need" method="POST">
          <label for="category">Assign Item:</label>
          <select name="category" required>
            <% Object.keys(categories).forEach(function(category) { %>
              <option value="<%= category %>"><%= category %></option>
            <% }) %>
          </select>
          <label for="item">Item:</label>
          <input type="text" name="item" required>
          <input type="hidden" name="member" value="<%= member.name %>">
          <input type="submit" value="Assign">
        </form>
      </li>
    <% }) %>
  </ul>
  
  <!-- Add Category Form -->
  <h3>Add Category:</h3>
  <form action="/add-category" method="POST">
    <label for="category">Category Name:</label>
    <input type="text" name="category" required>
    <input type="submit" value="Add Category">
  </form>
  
</body>
</html>
